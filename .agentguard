# AgentGuard Default Rules
# This file contains sensible defaults for protecting your system from dangerous commands
# executed by AI coding agents.
#
# Rule Syntax:
#   ! <pattern>  - BLOCK: Always prevent execution
#   ? <pattern>  - CONFIRM: Require user approval before execution
#   + <pattern>  - ALLOW: Explicitly permit execution without prompting
#   # <comment>  - Comment line (ignored)
#
# Rules are matched using glob patterns:
#   * matches zero or more characters
#   ? matches exactly one character
#
# Precedence: BLOCK > CONFIRM > ALLOW
# When multiple rules match, the most specific rule wins.

# ============================================================================
# CATASTROPHIC BLOCKS - Commands that could destroy your entire system
# ============================================================================

# Prevent deletion of root filesystem
!rm -rf /
!rm -rf /*
!rm -r /
!rm -r /*

# Prevent filesystem formatting
!mkfs.*
!mkfs *

# Prevent dangerous dd operations to block devices
!dd * of=/dev/sd*
!dd * of=/dev/hd*
!dd * of=/dev/nvme*
!dd * of=/dev/disk*

# Prevent wiping disks
!wipefs *
!shred /dev/*

# Prevent fork bombs and system resource exhaustion
!:(){ :|:& };:

# ============================================================================
# DANGEROUS CONFIRMS - Commands that need review before execution
# ============================================================================

# Confirm before deleting everything in current directory
?rm -rf *
?rm -r *

# Confirm before force pushing to git repositories
?git push --force
?git push -f
?git push --force-with-lease

# Confirm before deleting git branches
?git branch -D *

# Confirm before system-wide package operations
?sudo apt-get remove *
?sudo apt-get purge *
?sudo yum remove *
?sudo dnf remove *
?brew uninstall *

# Confirm before modifying system files
?sudo rm *
?sudo mv * /etc/*
?sudo cp * /etc/*

# Confirm before changing permissions recursively
?chmod -R *
?chown -R *

# Confirm before killing all processes
?killall *
?pkill *

# ============================================================================
# SAFE ALLOWS - Common cleanup operations that are safe to execute
# ============================================================================

# Allow deletion of common build artifacts and dependencies
+rm -rf node_modules
+rm -rf node_modules/
+rm -r node_modules
+rm -r node_modules/

+rm -rf dist
+rm -rf dist/
+rm -r dist
+rm -r dist/

+rm -rf build
+rm -rf build/
+rm -r build
+rm -r build/

+rm -rf .next
+rm -rf .next/
+rm -r .next
+rm -r .next/

+rm -rf out
+rm -rf out/
+rm -r out
+rm -r out/

+rm -rf target
+rm -rf target/
+rm -r target
+rm -r target/

# Allow deletion of common cache directories
+rm -rf .cache
+rm -rf .cache/
+rm -r .cache
+rm -r .cache/

+rm -rf __pycache__
+rm -rf __pycache__/
+rm -r __pycache__
+rm -r __pycache__/

+rm -rf .pytest_cache
+rm -rf .pytest_cache/
+rm -r .pytest_cache
+rm -r .pytest_cache/

# Allow deletion of common temporary directories
+rm -rf tmp
+rm -rf tmp/
+rm -r tmp
+rm -r tmp/

+rm -rf temp
+rm -rf temp/
+rm -r temp
+rm -r temp/

# Allow deletion of coverage reports
+rm -rf coverage
+rm -rf coverage/
+rm -r coverage
+rm -r coverage/

+rm -rf .nyc_output
+rm -rf .nyc_output/
+rm -r .nyc_output
+rm -r .nyc_output/

# ============================================================================
# NOTES
# ============================================================================
# 
# You can customize these rules by:
# 1. Creating a .agentguard file in your project directory (highest precedence)
# 2. Creating ~/.config/agentguard/rules in your home directory (medium precedence)
# 3. Creating /etc/agentguard/rules for system-wide rules (lowest precedence)
#
# Project rules override user rules, which override global rules.
# More specific patterns take precedence over less specific patterns.
#
# For more information, visit: https://github.com/yourusername/agentguard
